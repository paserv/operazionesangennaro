<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
<link rel="stylesheet" href="css/styles_time.css" />
<link rel="stylesheet" href="css/jquery-ui-timepicker-addon.css" />
<title>PSAR</title>
</head>

<body onLoad="getIds()">
<!-- <form method="post" action="FBpsarsplittask"> -->
<div class="header">
IdPagina: 
	<select id="pageId" name="pageId">
		<option value="anagraficaSindaco">Tutti</option>
    </select>
Social Network:
	<select id="socialNet" name="socialNet" onchange="getIds()">
		<option value="Plus">Plus</option>
		<option value="Facebook">Facebook</option>
		<option value="Youtube">Youtube</option>
	</select>
From: 
	<input type="text" id="from" name="from" />
To: 
	<input type="text" id="to" name="to" />
Mail:
	<input type="text" id="mail" name="mail" />
	<button id="getData">Get Data</button>
</div>
<!-- </form> -->
    
<div id="results"></div>

<script type="text/javascript" src="js/jquery-2.0.0.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.10.3.js"></script>
<script type="text/javascript" src="js/jquery-ui-timepicker-addon.js"></script>	

<script type="text/javascript">
$(function() {
	$('#from').datetimepicker({dateFormat: "dd-mm-yy", timeFormat: "HH:mm:ss"});
	$('#to').datetimepicker({dateFormat: "dd-mm-yy", timeFormat: "HH:mm:ss"});
});

$(document).ready(function() {

    $('#getData').click(function(){

        var pageId = $('#pageId').val();
        var socialNet = $('#socialNet').val();
        var from = $('#from').val();
        var to = $('#to').val();
        var mail = $('#mail').val();

        var idField;
        var servlet;
        if (socialNet == "Facebook") {
        	idField = "IDFacebook";
        	servlet = "FBpsarsplittask";
        }
        if (socialNet == "Plus") {
        	idField = "IDPlus";
        	servlet = "PLpsarsplittask";
        }
        if (socialNet == "Youtube") {
        	idField = "IDYoutube";
        	servlet = "YOpsarsplittask";
        }
        
        var dataString = "pageId=" + pageId + "&from=" + from + "&to=" + to + "&mail=" + mail + "&IDField=" + idField;
        $.ajax({
        type: "POST",
        url: servlet,
        data: dataString,
        success: function(data){
        $('#results').show();
        $('#results').html(data);
    }
 });
});

    
});


//Populate Select Box
function getIds () {
	var socialNet = $('#socialNet').val();
	var idField;
	if (socialNet == "Facebook") {
		idField = "IDFacebook";
	}
	if (socialNet == "Plus") {
    	idField = "IDPlus";
    }
    if (socialNet == "Youtube") {
    	idField = "IDYoutube";
    }
	$.ajax({
		type: 'GET',
		url: "http://08-monitorfacebookpages.appspot.com/rest/table/resource/anagraficaSindaco/" + idField,
		dataType: "json",
		success: function(data) {
				console.log(data);
				
				$.each(data, function() {	
					$.each(this, function(key, value) {
						$('#pageId').append($("<option/>", {
					        value: this.identificativo,
					        text: this.nome
					    }));
					});
				});
		}
	});
};

</script>
</body>
</html>
